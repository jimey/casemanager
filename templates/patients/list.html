{% extends 'base.html' %}
{% block title %}患者列表{% endblock %}
{% block content %}
<h1>患者</h1>
<form method="get" class="inline">
  <input type="text" name="q" value="{{ q }}" placeholder="搜索姓名" />
  <button type="submit">搜索</button>
  <a class="btn" href="{{ url_for('main.patients_new') }}">+ 新建患者</a>
 </form>
<table>
  <thead><tr><th>ID</th><th>姓名</th><th>性别</th><th>出生日期</th><th>电话</th><th>地址</th><th>操作</th></tr></thead>
  <tbody>
    {% for p in patients %}
    <tr>
      <td>{{ p.id }}</td>
      <td><a href="{{ url_for('main.patients_detail', pid=p.id) }}">{{ p.name }}</a></td>
      <td>{{ p.gender or '-' }}</td>
      <td>{{ p.dob.strftime('%Y-%m-%d') if p.dob else '-' }}</td>
      <td>{{ p.contact or '-' }}</td>
      <td>{{ p.address or '-' }}</td>
      <td>
        <a href="{{ url_for('main.patients_edit', pid=p.id) }}">编辑</a>
        <form method="post" action="{{ url_for('main.patients_delete', pid=p.id) }}" class="inline" onsubmit="return confirm('确认删除?')">
          <button type="submit" class="link danger">删除</button>
        </form>
      </td>
    </tr>
    {% else %}
    <tr><td colspan="7">暂无患者</td></tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}

